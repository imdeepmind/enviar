{"version":3,"sources":["../../app/controller/resource.js"],"names":["getImage","req","res","type","params","file","resolution","path1","path2","myPath","logger","debug","sendFile","root","boom","notFound","messages"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEO,IAAMA,8BAAW,SAAXA,QAAW,CAACC,GAAD,EAAMC,GAAN,EAAc;AAClC,QAAMC,OAAO,mBAAIF,IAAIG,MAAJ,CAAWD,IAAf,CAAb;AACA,QAAME,OAAO,mBAAIJ,IAAIG,MAAJ,CAAWC,IAAf,CAAb;AACA,QAAMC,aAAa,mBAAIL,IAAIG,MAAJ,CAAWE,UAAf,CAAnB;;AAEA,QAAIC,QAAQ,EAAZ;AACA,QAAIJ,SAAS,MAAb,EACII,QAAQ,OAAR,CADJ,KAEK,IAAIJ,SAAS,SAAb,EACDI,QAAQ,QAAR;;AAEJ,QAAIC,QAAQ,EAAZ;AACA,QAAIF,eAAe,UAAnB,EACIE,QAAQ,KAAR,CADJ,KAEK,IAAIF,eAAe,QAAnB,EAA4B;AAC7B,YAAIH,SAAS,SAAb,EACIK,QAAQ,UAAR,CADJ,KAEK,IAAIL,SAAS,MAAb,EACDK,QAAQ,UAAR;AACP,KALI,MAKE,IAAIF,eAAe,OAAf,IAA0BH,QAAQ,SAAtC,EACHK,QAAQ,QAAR;;AAEJ,QAAID,SAAS,EAAT,IAAeC,SAAS,EAA5B,EAA+B;AAC3B,YAAMC,SAASD,QAAQ,GAAR,GAAcH,IAA7B;AACAK,yBAAOC,KAAP,2CAAqDF,MAArD;AACA,eAAOP,IAAIU,QAAJ,CAAaH,MAAb,EAAsB,EAAEI,MAAON,QAAQ,GAAjB,EAAtB,CAAP;AACH,KAJD,MAIO;AACHG,yBAAOC,KAAP,CAAa,0BAAb;AACA,eAAOT,IAAIY,IAAJ,CAASC,QAAT,CAAkBC,mBAAS,QAAT,CAAlB,CAAP;AACH;AACJ,CA9BM","file":"resource.js","sourcesContent":["import xss from 'xss';\nimport messages from '../messages';\nimport logger from '../utils/logger';\n\nexport const getImage = (req, res) => {\n    const type = xss(req.params.type);\n    const file = xss(req.params.file);\n    const resolution = xss(req.params.resolution);\n\n    let path1 = '';\n    if (type === 'post')\n        path1 = 'posts';\n    else if (type === 'profile')\n        path1 = 'images';\n\n    let path2 = '';\n    if (resolution === 'original')\n        path2 = 'raw';\n    else if (resolution === 'medium'){\n        if (type === 'profile')\n            path2 = 'r200x200';\n        else if (type === 'post')\n            path2 = 'r500x500';\n    } else if (resolution === 'small' && type == 'profile')\n        path2 = 'r48x48';\n    \n    if (path1 != '' && path2 != ''){\n        const myPath = path2 + '/' + file;\n        logger.debug(`Sending the file with following path ${myPath}`);\n        return res.sendFile(myPath,  { root:  path1 + '/' });\n    } else {\n        logger.debug('Resource does not exists');\n        return res.boom.notFound(messages['m404.3']);\n    }\n}"]}